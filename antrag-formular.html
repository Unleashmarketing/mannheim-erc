<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Antrag Eislaufschule - Mannheimer ERC</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    /* ========================================
       CSS VARIABLES - Zentrale Steuerung
       ======================================== */
    :root {
      /* Farben */
      --primary-color: #0062ff;
      --primary-hover: #0052d9;
      --secondary-color: #e4e3d3;
      --dark-bg: #111111;
      --light-bg: #f7f7f2;
      --accent-color: #ff3a29;
      --text-dark: #222222;
      --text-light: #f7f7f7;
      --text-muted: #555555;
      --gray-light: #e0e0e0;
      --gray-medium: #999999;
      --white: #ffffff;
      
      /* Spacing System */
      --spacing-xs: 8px;
      --spacing-sm: 16px;
      --spacing-md: 24px;
      --spacing-lg: 40px;
      --spacing-xl: 60px;
      --spacing-2xl: 80px;
      --spacing-3xl: 120px;
      
      /* Typography */
      --font-family: "Outfit", -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      --font-family-accent: "Space Grotesk", monospace;
      --font-size-xs: 0.875rem;
      --font-size-sm: 1rem;
      --font-size-md: 1.125rem;
      --font-size-lg: 1.5rem;
      --font-size-xl: 2rem;
      --font-size-2xl: 2.5rem;
      --font-size-3xl: 3rem;
      
      /* Layout */
      --border-radius-sm: 4px;
      --border-radius-md: 8px;
      --border-radius-lg: 12px;
      --max-width: 1300px;
      --header-height: 80px;
      
      /* Transitions */
      --transition-fast: 0.15s ease;
      --transition-base: 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);
      --transition-slow: 0.6s cubic-bezier(0.165, 0.84, 0.44, 1);
      
      /* Shadows */
      --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.08);
      --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.12);
      --shadow-xl: 0 16px 48px rgba(0, 0, 0, 0.15);
    }

    /* ========================================
       RESET & BASE STYLES
       ======================================== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
      font-size: 16px;
    }

    body {
      font-family: var(--font-family);
      background-color: var(--light-bg);
      color: var(--text-dark);
      line-height: 1.6;
      overflow-x: hidden;
      font-weight: 400;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      padding: var(--spacing-lg) 0;
    }

    /* ========================================
       FORM CONTAINER
       ======================================== */
    .form-container {
      max-width: 900px;
      margin: 0 auto;
      background: var(--white);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-lg);
      overflow: hidden;
    }

    .form-header {
      background: linear-gradient(135deg, var(--primary-color) 0%, #0047b3 100%);
      color: var(--white);
      padding: var(--spacing-2xl) var(--spacing-lg);
      text-align: center;
      position: relative;
    }

    .form-header::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-image: url('data:image/svg+xml,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="grid" width="100" height="100" patternUnits="userSpaceOnUse"><path d="M 100 0 L 0 0 0 100" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="1"/></pattern></defs><rect width="100%" height="100%" fill="url(%23grid)"/></svg>');
      opacity: 0.3;
    }

    .form-header-content {
      position: relative;
      z-index: 2;
    }

    .form-header h1 {
      font-family: var(--font-family-accent);
      font-size: var(--font-size-2xl);
      font-weight: 900;
      margin-bottom: var(--spacing-sm);
      letter-spacing: -1px;
      line-height: 1.2;
    }

    .form-header p {
      opacity: 0.95;
      font-size: var(--font-size-md);
      line-height: 1.8;
    }

    .form-body {
      padding: var(--spacing-2xl) var(--spacing-lg);
    }

    /* ========================================
       FORM SECTIONS
       ======================================== */
    .form-section {
      margin-bottom: var(--spacing-2xl);
    }

    .form-section h2 {
      font-family: var(--font-family-accent);
      font-size: var(--font-size-xl);
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: var(--spacing-lg);
      padding-bottom: var(--spacing-sm);
      border-bottom: 3px solid var(--gray-light);
      letter-spacing: -0.5px;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-md);
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    .form-group.full-width {
      grid-column: 1 / -1;
    }

    label {
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: var(--spacing-xs);
      font-size: var(--font-size-sm);
    }

    label .required {
      color: var(--accent-color);
      margin-left: 4px;
    }

    /* ========================================
       FORM INPUTS
       ======================================== */
    input, select, textarea {
      padding: 14px 16px;
      border: 2px solid var(--gray-light);
      border-radius: var(--border-radius-md);
      font-size: var(--font-size-sm);
      transition: var(--transition-base);
      font-family: inherit;
      background-color: var(--white);
      color: var(--text-dark);
    }

    input:hover, select:hover, textarea:hover {
      border-color: var(--gray-medium);
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(0, 98, 255, 0.1);
    }

    select {
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23333' d='M10.293 3.293L6 7.586 1.707 3.293A1 1 0 00.293 4.707l5 5a1 1 0 001.414 0l5-5a1 1 0 10-1.414-1.414z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 16px center;
      padding-right: 40px;
    }

    /* ========================================
       CHECKBOX
       ======================================== */
    .checkbox-group {
      display: flex;
      align-items: flex-start;
      gap: var(--spacing-sm);
      padding: var(--spacing-md);
      background-color: var(--light-bg);
      border-radius: var(--border-radius-md);
      border: 2px solid transparent;
      transition: var(--transition-base);
    }

    .checkbox-group:hover {
      border-color: var(--gray-light);
    }

    .checkbox-group input[type="checkbox"] {
      width: 20px;
      height: 20px;
      min-width: 20px;
      cursor: pointer;
      margin-top: 2px;
    }

    .checkbox-group label {
      margin: 0;
      cursor: pointer;
      font-weight: 500;
      line-height: 1.6;
    }

    /* ========================================
       INFO BOX
       ======================================== */
    .info-box {
      background: rgba(0, 98, 255, 0.05);
      border-left: 4px solid var(--primary-color);
      padding: var(--spacing-md);
      margin-bottom: var(--spacing-md);
      border-radius: var(--border-radius-sm);
    }

    .info-box p {
      color: var(--text-muted);
      line-height: 1.7;
      font-size: var(--font-size-sm);
    }

    .info-box strong {
      color: var(--text-dark);
    }

    /* ========================================
       ALERTS
       ======================================== */
    .alert {
      padding: var(--spacing-md);
      border-radius: var(--border-radius-md);
      margin-bottom: var(--spacing-md);
      font-size: var(--font-size-sm);
      line-height: 1.6;
    }

    .alert-error {
      background: rgba(255, 58, 41, 0.1);
      border-left: 4px solid var(--accent-color);
      color: #c00;
    }

    .alert-success {
      background: rgba(16, 185, 129, 0.1);
      border-left: 4px solid #10b981;
      color: #065f46;
    }

    /* ========================================
       BUTTONS
       ======================================== */
    .btn-container {
      display: flex;
      gap: var(--spacing-md);
      justify-content: flex-end;
      margin-top: var(--spacing-2xl);
      padding-top: var(--spacing-lg);
      border-top: 2px solid var(--gray-light);
    }

    button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: var(--spacing-xs);
      padding: 16px 32px;
      border: none;
      border-radius: var(--border-radius-md);
      font-size: var(--font-size-sm);
      font-weight: 600;
      font-family: var(--font-family-accent);
      cursor: pointer;
      transition: var(--transition-base);
      position: relative;
      overflow: hidden;
    }

    button::before {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.1);
      transition: var(--transition-base);
    }

    button:hover::before {
      left: 0;
    }

    button:hover {
      transform: translateY(-3px);
    }

    .btn-primary {
      background-color: var(--primary-color);
      color: var(--white);
      box-shadow: var(--shadow-md);
    }

    .btn-primary:hover {
      background-color: var(--primary-hover);
      box-shadow: var(--shadow-lg);
    }

    .btn-primary:disabled {
      background: var(--gray-medium);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .btn-primary:disabled::before {
      display: none;
    }

    .btn-secondary {
      background-color: transparent;
      color: var(--text-dark);
      border: 2px solid var(--gray-light);
    }

    .btn-secondary:hover {
      background-color: var(--light-bg);
      border-color: var(--gray-medium);
    }

    /* ========================================
       RESPONSIVE DESIGN
       ======================================== */
    @media (max-width: 768px) {
      body {
        padding: var(--spacing-md) var(--spacing-sm);
      }

      .form-row {
        grid-template-columns: 1fr;
      }

      .form-body {
        padding: var(--spacing-lg) var(--spacing-md);
      }

      .form-header {
        padding: var(--spacing-xl) var(--spacing-md);
      }

      .form-header h1 {
        font-size: var(--font-size-xl);
      }

      .btn-container {
        flex-direction: column-reverse;
      }

      button {
        width: 100%;
      }
    }

    @media (max-width: 576px) {
      .form-header h1 {
        font-size: var(--font-size-lg);
      }

      .form-section h2 {
        font-size: var(--font-size-lg);
      }
    }
  </style>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    rel="stylesheet"
  />
</head>
<body>
  <div class="form-container">
    <div class="form-header">
      <div class="form-header-content">
        <h1>Antrag Eislaufschule 2026</h1>
        <p>Bitte füllen Sie alle erforderlichen Felder aus</p>
      </div>
    </div>

    <div class="form-body">
      <div id="alertContainer"></div>

      <form id="antragForm">
        
        <!-- Persönliche Daten -->
        <div class="form-section">
          <h2>Persönliche Daten</h2>
          
          <div class="form-row">
            <div class="form-group">
              <label>Nachname <span class="required">*</span></label>
              <input type="text" name="Name" required>
            </div>
            <div class="form-group">
              <label>Vorname <span class="required">*</span></label>
              <input type="text" name="Vorname" required>
            </div>
          </div>

          <div class="form-group full-width">
            <label>Straße und Hausnummer <span class="required">*</span></label>
            <input type="text" name="Straße" required>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Postleitzahl <span class="required">*</span></label>
              <input type="text" name="PLZ" pattern="[0-9]{5}" required>
            </div>
            <div class="form-group">
              <label>Wohnort <span class="required">*</span></label>
              <input type="text" name="Wohnort" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Geburtsdatum <span class="required">*</span></label>
              <input type="date" name="Geburtsdatum" required>
            </div>
            <div class="form-group">
              <label>Geschlecht <span class="required">*</span></label>
              <select name="Geschlecht" required>
                <option value="">Bitte wählen</option>
                <option value="M">Männlich</option>
                <option value="W">Weiblich</option>
                <option value="D">Divers</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label>Staatsangehörigkeit <span class="required">*</span></label>
            <input type="text" name="Staatsangehörigkeit" value="Deutsch" required>
          </div>
        </div>

        <!-- Kontaktdaten -->
        <div class="form-section">
          <h2>Kontaktdaten</h2>
          
          <div class="form-row">
            <div class="form-group">
              <label>Telefon/Mobil <span class="required">*</span></label>
              <input type="tel" name="Telefon/Mobil" placeholder="+49 123 456789" required>
            </div>
            <div class="form-group">
              <label>E-Mail <span class="required">*</span></label>
              <input type="email" name="e-Mail" required>
            </div>
          </div>
        </div>

        <!-- Abteilung -->
        <div class="form-section">
          <h2>Abteilung</h2>
          
          <div class="form-row">
            <div class="form-group">
              <label>Abteilung <span class="required">*</span></label>
              <select name="Abteilung" id="abteilung" required>
                <option value="">Bitte wählen</option>
                <option value="Kunstlauf">Eiskunstlauf</option>
                <option value="Schnelllauf">Eisschnelllauf / Shorttrack</option>
              </select>
            </div>
            <div class="form-group">
              <label>Unterabteilung</label>
              <select name="Unterabteilung" id="unterabteilung">
                <option value="">Bitte wählen</option>
              </select>
            </div>
          </div>

          <div class="info-box">
            <p><strong>Hinweis:</strong> Die Unterabteilung ist optional und wird basierend auf Ihrer gewählten Abteilung angezeigt.</p>
          </div>
        </div>

        <!-- Bankverbindung -->
        <div class="form-section">
          <h2>Bankverbindung</h2>
          
          <div class="form-group">
            <label>Name des Kreditinstituts <span class="required">*</span></label>
            <input type="text" name="Name Kreditinstitut" required>
          </div>

          <div class="form-group">
            <label>Kontoinhaber <span class="required">*</span></label>
            <input type="text" name="Kontoinhaber" required>
          </div>

          <div class="form-group">
            <label>IBAN <span class="required">*</span></label>
            <input type="text" name="IBAN" placeholder="DE00 0000 0000 0000 0000 00" required>
          </div>

          <div class="form-group full-width">
            <div class="checkbox-group">
              <input type="checkbox" id="einzug" name="Einzugsermächtigung" required>
              <label for="einzug">
                Ich erteile die Einzugsermächtigung für den Beitragseinzug <span class="required">*</span>
              </label>
            </div>
          </div>
        </div>

        <!-- Buttons -->
        <div class="btn-container">
          <button type="button" class="btn-secondary" onclick="window.history.back()">Zurück</button>
          <button type="submit" class="btn-primary" id="submitBtn">
            <span id="btnText">PDF erstellen & herunterladen</span>
          </button>
        </div>
      </form>
    </div>
  </div>

  <script>
    const { jsPDF } = window.jspdf;

    // Dynamische Unterabteilungen
    const abteilungSelect = document.getElementById('abteilung');
    const unterabteilungSelect = document.getElementById('unterabteilung');

    const unterabteilungen = {
      'Kunstlauf': [
        { value: 'Einzel', label: 'Einzel' },
        { value: 'Paarlauf', label: 'Paarlauf' },
        { value: 'Formation', label: 'Formation / Synchron' },
        { value: 'Erwachsene', label: 'Erwachsene' }
      ],
      'Schnelllauf': [
        { value: 'Shorttrack', label: 'Shorttrack' }
      ]
    };

    abteilungSelect.addEventListener('change', function() {
      unterabteilungSelect.innerHTML = '<option value="">Bitte wählen</option>';
      
      if (this.value && unterabteilungen[this.value]) {
        unterabteilungen[this.value].forEach(option => {
          const opt = document.createElement('option');
          opt.value = option.value;
          opt.textContent = option.label;
          unterabteilungSelect.appendChild(opt);
        });
      }
    });

    // IBAN Validierung
    function isValidIBAN(iban) {
      const CODE_LENGTHS = {
        AD: 24, AE: 23, AT: 20, AZ: 28, BA: 20, BE: 16, BG: 22, BH: 22,
        BR: 29, CH: 21, CR: 21, CY: 28, CZ: 24, DE: 22, DK: 18, DO: 28,
        EE: 20, ES: 24, FI: 18, FO: 18, FR: 27, GB: 22, GI: 23, GL: 18,
        GR: 27, GT: 28, HR: 21, HU: 28, IE: 22, IL: 23, IS: 26, IT: 27,
        JO: 30, KW: 30, KZ: 20, LB: 28, LI: 21, LT: 20, LU: 20, LV: 21,
        MC: 27, MD: 24, ME: 22, MK: 19, MR: 27, MT: 31, MU: 30, NL: 18,
        NO: 15, PK: 24, PL: 28, PS: 29, PT: 25, QA: 29, RO: 24, RS: 22,
        SA: 24, SE: 24, SI: 19, SK: 24, SM: 27, TN: 24, TR: 26
      };

      const cleanIban = String(iban).toUpperCase().replace(/[^A-Z0-9]/g, '');
      const code = cleanIban.match(/^([A-Z]{2})(\d{2})([A-Z\d]+)$/);
      
      if (!code || cleanIban.length !== CODE_LENGTHS[code[1]]) {
        return false;
      }

      const digits = (code[3] + code[1] + code[2]).replace(/[A-Z]/g, (letter) => {
        return letter.charCodeAt(0) - 55;
      });

      // Modulo 97 Berechnung
      let checksum = digits.slice(0, 2);
      for (let offset = 2; offset < digits.length; offset += 7) {
        const fragment = String(checksum) + digits.substring(offset, offset + 7);
        checksum = parseInt(fragment, 10) % 97;
      }
      
      return checksum === 1;
    }

    function showAlert(message, type = 'error') {
      const alertContainer = document.getElementById('alertContainer');
      const alertClass = type === 'success' ? 'alert-success' : 'alert-error';
      alertContainer.innerHTML = `
        <div class="alert ${alertClass}">
          ${message}
        </div>
      `;
      alertContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      
      if (type === 'success') {
        setTimeout(() => {
          alertContainer.innerHTML = '';
        }, 5000);
      }
    }

    function generatePDF(formData) {
      const doc = new jsPDF();
      
      // Titel
      doc.setFontSize(18);
      doc.setFont(undefined, 'bold');
      doc.text('Antrag Eislaufschule 2024/2025', 20, 20);
      
      doc.setFontSize(11);
      doc.setFont(undefined, 'normal');
      
      let yPos = 35;
      const lineHeight = 8;
      const leftMargin = 20;
      
      // Persönliche Daten
      doc.setFont(undefined, 'bold');
      doc.text('Persönliche Daten:', leftMargin, yPos);
      doc.setFont(undefined, 'normal');
      yPos += lineHeight;
      
      doc.text(`Name: ${formData.Name}`, leftMargin + 5, yPos);
      yPos += lineHeight;
      doc.text(`Vorname: ${formData.Vorname}`, leftMargin + 5, yPos);
      yPos += lineHeight;
      doc.text(`Straße: ${formData['Straße']}`, leftMargin + 5, yPos);
      yPos += lineHeight;
      doc.text(`PLZ: ${formData.PLZ}`, leftMargin + 5, yPos);
      yPos += lineHeight;
      doc.text(`Wohnort: ${formData.Wohnort}`, leftMargin + 5, yPos);
      yPos += lineHeight;
      doc.text(`Geburtsdatum: ${formData.Geburtsdatum}`, leftMargin + 5, yPos);
      yPos += lineHeight;
      doc.text(`Geschlecht: ${formData.Geschlecht}`, leftMargin + 5, yPos);
      yPos += lineHeight;
      doc.text(`Staatsangehörigkeit: ${formData['Staatsangehörigkeit']}`, leftMargin + 5, yPos);
      yPos += lineHeight + 5;
      
      // Kontaktdaten
      doc.setFont(undefined, 'bold');
      doc.text('Kontaktdaten:', leftMargin, yPos);
      doc.setFont(undefined, 'normal');
      yPos += lineHeight;
      
      doc.text(`Telefon/Mobil: ${formData['Telefon/Mobil']}`, leftMargin + 5, yPos);
      yPos += lineHeight;
      doc.text(`E-Mail: ${formData['e-Mail']}`, leftMargin + 5, yPos);
      yPos += lineHeight + 5;
      
      // Abteilung
      doc.setFont(undefined, 'bold');
      doc.text('Abteilung:', leftMargin, yPos);
      doc.setFont(undefined, 'normal');
      yPos += lineHeight;
      
      doc.text(`Abteilung: ${formData.Abteilung}`, leftMargin + 5, yPos);
      yPos += lineHeight;
      if (formData.Unterabteilung) {
        doc.text(`Unterabteilung: ${formData.Unterabteilung}`, leftMargin + 5, yPos);
        yPos += lineHeight;
      }
      yPos += 5;
      
      // Bankverbindung
      doc.setFont(undefined, 'bold');
      doc.text('Bankverbindung:', leftMargin, yPos);
      doc.setFont(undefined, 'normal');
      yPos += lineHeight;
      
      doc.text(`Name Kreditinstitut: ${formData['Name Kreditinstitut']}`, leftMargin + 5, yPos);
      yPos += lineHeight;
      doc.text(`Kontoinhaber: ${formData.Kontoinhaber}`, leftMargin + 5, yPos);
      yPos += lineHeight;
      doc.text(`IBAN: ${formData.IBAN}`, leftMargin + 5, yPos);
      yPos += lineHeight;
      doc.text(`Einzugsermächtigung: Ja`, leftMargin + 5, yPos);
      yPos += lineHeight + 10;
      
      // Erstellungsdatum
      doc.setFontSize(9);
      doc.text(`Erstellt am: ${new Date().toLocaleDateString('de-DE')} um ${new Date().toLocaleTimeString('de-DE')}`, leftMargin, yPos);
      
      // PDF speichern
      const fileName = `Antrag_Eislaufschule_${formData.Name}_${formData.Vorname}.pdf`;
      doc.save(fileName);
    }

    // Formular-Handling
    document.getElementById('antragForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const submitBtn = document.getElementById('submitBtn');
      const btnText = document.getElementById('btnText');
      
      // Button deaktivieren
      submitBtn.disabled = true;
      btnText.textContent = 'PDF wird erstellt...';
      
      // Formulardaten sammeln
      const formData = new FormData(this);
      const data = {};
      
      for (let [key, value] of formData.entries()) {
        if (key === 'Einzugsermächtigung') {
          data[key] = 'ja';
        } else {
          data[key] = value.trim();
        }
      }
      
      // Validierung
      // IBAN prüfen
      if (!isValidIBAN(data.IBAN)) {
        showAlert('Bitte geben Sie eine gültige IBAN ein.');
        submitBtn.disabled = false;
        btnText.textContent = 'PDF erstellen & herunterladen';
        return;
      }
      
      // PLZ prüfen
      if (!/^\d{5}$/.test(data.PLZ)) {
        showAlert('Bitte geben Sie eine gültige 5-stellige Postleitzahl ein.');
        submitBtn.disabled = false;
        btnText.textContent = 'PDF erstellen & herunterladen';
        return;
      }
      
      // Email prüfen
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(data['e-Mail'])) {
        showAlert('Bitte geben Sie eine gültige E-Mail-Adresse ein.');
        submitBtn.disabled = false;
        btnText.textContent = 'PDF erstellen & herunterladen';
        return;
      }
      
      try {
        // PDF generieren
        generatePDF(data);
        
        showAlert('PDF wurde erfolgreich erstellt und heruntergeladen!', 'success');
        
        // Formular zurücksetzen nach 2 Sekunden
        setTimeout(() => {
          this.reset();
          submitBtn.disabled = false;
          btnText.textContent = 'PDF erstellen & herunterladen';
        }, 2000);
        
      } catch (error) {
        console.error('Fehler beim Erstellen des PDFs:', error);
        showAlert('Fehler beim Erstellen des PDFs. Bitte versuchen Sie es erneut.');
        submitBtn.disabled = false;
        btnText.textContent = 'PDF erstellen & herunterladen';
      }
    });
  </script>
</body>
</html>
